# Dark Horse 3D - 게임적 요소 개선 계획

## 분석 개요

**분석일**: 2026-02-05  
**목적**: 게임의 재미와 몰입감을 높이기 위한 개선점 도출

---

## 현재 구현 상태 요약

### 구현 완료된 기능
| 기능 | 상태 | 위치 |
|------|------|------|
| 기본 턴 시스템 | ✅ | GameEngine.js |
| 카드 시스템 (4종류) | ✅ | CardProcessor.js |
| 다크호스 토큰 | ✅ | GameState.js |
| 점수 계산 | ✅ | ScoreCalculator.js |
| 3D 말 모델 & 달리기 애니메이션 | ✅ | HorseModel.js, SceneManager.js |
| AI 턴 (랜덤) | ✅ | GameEngine.js |
| 결과 화면 | ✅ | UIManager.js |
| 키보드 단축키 | ✅ | UIManager.js |

### 미구현 기능 (게임 규칙 대비)
| 기능 | 규칙 참조 | 상태 |
|------|-----------|------|
| 베팅 카드 교환 (Exchange Betting Card) | GAME_RULES.md §5 | ❌ |
| 다중 말 카드 (2마리 동시 이동) | GAME_RULES.md §5 | ❌ |
| 플레이어 수 설정 (2-6인) | GAME_RULES.md §1 | ❌ (4인 고정) |
| 말 배치 페이즈 (플레이어가 순서 결정) | GAME_RULES.md §4.2 | ❌ (랜덤) |
| 베팅 카드 선택 | GAME_RULES.md §4.1 | ❌ (랜덤) |

---

## 개선 과제 목록

### Priority 1: 핵심 게임플레이 (Critical)

#### T1.1 베팅 카드 선택 시스템
**현재**: 게임 시작 시 랜덤하게 베팅 카드 2장 배정  
**목표**: 플레이어가 직접 베팅할 말 2마리 선택

**구현 내용:**
- [ ] 게임 시작 전 베팅 카드 선택 UI 구현
- [ ] 7마리 말 중 2마리 선택 가능
- [ ] 선택 완료 후 게임 시작
- [ ] AI는 전략적으로 베팅 카드 선택 (또는 랜덤)

**예상 난이도**: ⭐⭐  
**예상 시간**: 3-4시간

---

#### T1.2 말 배치 페이즈 구현
**현재**: 게임 시작 시 말 순서 랜덤 배치  
**목표**: 규칙대로 플레이어가 번갈아가며 말 배치

**구현 내용:**
- [ ] 말 배치 페이즈 상태 추가 (GameState)
- [ ] 배치 UI 구현 (왼쪽/오른쪽 선택)
- [ ] 턴 순서대로 배치 진행
- [ ] AI 배치 로직 구현
- [ ] 마지막 남은 말이 다크호스로 결정

**참조**: GAME_RULES.md §4.2  
**예상 난이도**: ⭐⭐⭐  
**예상 시간**: 4-5시간

---

#### T1.3 Exchange Betting Card 구현
**현재**: 카드 타입에 없음  
**목표**: 베팅 카드 교환 카드 추가

**구현 내용:**
- [ ] `exchange_betting` 카드 타입 추가 (GameConfig.js)
- [ ] CardProcessor에서 처리 로직 구현
- [ ] 옵션 선택 UI (본인 교환 vs 상대 교환)
- [ ] 베팅 카드 스택에서 새 카드 뽑기
- [ ] 공개 후 교환 애니메이션

**참조**: GAME_RULES.md §5 (Special Cards)  
**예상 난이도**: ⭐⭐⭐  
**예상 시간**: 4-5시간

---

#### T1.4 다중 말 카드 구현
**현재**: 한 번에 1마리만 이동  
**목표**: 2마리 동시 이동 카드 추가

**구현 내용:**
- [ ] `multi_move` 카드 타입 추가
- [ ] 카드 데이터에 `targets: [4, 6]` 형태로 저장
- [ ] CardProcessor에서 2마리 순차 이동 처리
- [ ] 같은 방향으로만 이동 강제
- [ ] UI에서 다중 말 카드 표시

**참조**: GAME_RULES.md §5 (Cards with Multiple Horses)  
**예상 난이도**: ⭐⭐⭐  
**예상 시간**: 3-4시간

---

### Priority 2: 게임 경험 향상 (High)

#### T2.1 사운드 시스템 도입
**현재**: 무음  
**목표**: 게임 사운드로 몰입감 향상

**구현 내용:**
- [ ] SoundManager 클래스 생성
- [ ] 효과음 추가:
  - 카드 플레이 (슉~)
  - 말 이동 (달그닥 발굽 소리)
  - 토큰 획득 (띵!)
  - 낙마 (쾅!)
  - 게임 승리 (팡파레)
  - 게임 시작
- [ ] 배경 음악 (선택적)
- [ ] 음소거 토글 버튼
- [ ] 볼륨 조절

**예상 난이도**: ⭐⭐  
**예상 시간**: 3-4시간

---

#### T2.2 시각 효과 (VFX) 추가
**현재**: 기본 이동 애니메이션만  
**목표**: 파티클 및 효과로 피드백 강화

**구현 내용:**
- [ ] 카드 플레이 시 빛나는 효과
- [ ] 말 이동 시 먼지 파티클
- [ ] 순위 변경 시 화살표 애니메이션
- [ ] 다크호스 말에 특수 오라 효과
- [ ] 낙마 시 폭발 이펙트
- [ ] 승리 시 컨페티 (종이 조각) 효과
- [ ] 내 말 하이라이트 강화

**예상 난이도**: ⭐⭐⭐  
**예상 시간**: 5-6시간

---

#### T2.3 AI 전략 개선
**현재**: 완전 랜덤  
**목표**: 전략적 AI로 게임 난이도 향상

**구현 내용:**
- [ ] AIPlayer 클래스 분리
- [ ] 난이도 레벨 (Easy/Normal/Hard)
- [ ] Easy: 랜덤 (현재)
- [ ] Normal: 자기 말 우선 전진
- [ ] Hard: 상대 말 분석, 최적 카드 선택
- [ ] 토큰 획득 전략 (다크호스 순위 분석)
- [ ] AI 사고 표시 (말풍선 또는 딜레이)

**예상 난이도**: ⭐⭐⭐⭐  
**예상 시간**: 6-8시간

---

#### T2.4 게임 시작 설정 화면
**현재**: 즉시 게임 시작  
**목표**: 게임 설정 후 시작

**구현 내용:**
- [ ] 시작 화면 UI 구현
- [ ] 플레이어 수 선택 (2-6인)
- [ ] AI 난이도 선택
- [ ] 플레이어 닉네임 입력
- [ ] 게임 규칙 미리보기
- [ ] "게임 시작" 버튼

**예상 난이도**: ⭐⭐⭐  
**예상 시간**: 4-5시간

---

### Priority 3: UX 개선 (Medium)

#### T3.1 카드 정보 팝업/툴팁
**현재**: 카드에 기본 정보만 표시  
**목표**: 상세 설명과 예측 효과 표시

**구현 내용:**
- [ ] 카드 호버 시 상세 툴팁
- [ ] 이 카드 사용 시 예상 순위 변화 미리보기
- [ ] 카드 타입별 설명 (규칙 참조)
- [ ] 영향받는 말 하이라이트

**예상 난이도**: ⭐⭐  
**예상 시간**: 2-3시간

---

#### T3.2 진행 상황 표시 개선
**현재**: 남은 카드 수만 표시  
**목표**: 게임 진행률 명확히 표시

**구현 내용:**
- [ ] 라운드/턴 카운터
- [ ] 프로그레스 바 (전체 진행률)
- [ ] "마지막 라운드" 알림
- [ ] 각 플레이어 남은 카드 시각화

**예상 난이도**: ⭐  
**예상 시간**: 1-2시간

---

#### T3.3 결과 화면 개선
**현재**: 순위와 점수만 표시  
**목표**: 상세 분석 및 하이라이트

**구현 내용:**
- [ ] 각 베팅 말의 최종 순위 표시
- [ ] 다크호스 결과 강조
- [ ] 각 플레이어 점수 breakdown
- [ ] "내 베팅 분석" 섹션
- [ ] "다시 하기" 버튼 애니메이션
- [ ] 승자 축하 애니메이션

**예상 난이도**: ⭐⭐  
**예상 시간**: 2-3시간

---

#### T3.4 튜토리얼 시스템
**현재**: 없음  
**목표**: 신규 플레이어 온보딩

**구현 내용:**
- [ ] 첫 실행 시 튜토리얼 모달
- [ ] 단계별 게임 설명 (5-7단계)
- [ ] 하이라이트 마스크 (주목해야 할 UI)
- [ ] 스킵 가능
- [ ] "다시 보기" 버튼 (설정에서)

**예상 난이도**: ⭐⭐⭐  
**예상 시간**: 4-5시간

---

### Priority 4: 고급 기능 (Low)

#### T4.1 레이싱 카메라 모드
**현재**: 고정 탑뷰 + 드래그  
**목표**: 다양한 카메라 앵글

**구현 내용:**
- [ ] 카메라 모드 전환 버튼
- [ ] 탑뷰 (현재)
- [ ] 추적 카메라 (1등 말 따라가기)
- [ ] 내 말 추적 모드
- [ ] 시네마틱 뷰 (회전)
- [ ] 자유 카메라 (WASD 이동)

**예상 난이도**: ⭐⭐⭐  
**예상 시간**: 4-5시간

---

#### T4.2 게임 리플레이 기능
**현재**: 없음  
**목표**: 게임 기록 및 다시보기

**구현 내용:**
- [ ] 모든 턴 기록 저장
- [ ] 게임 종료 후 "다시보기" 버튼
- [ ] 턴별 되감기/재생
- [ ] 배속 조절
- [ ] 하이라이트 순간 자동 캡처

**예상 난이도**: ⭐⭐⭐⭐  
**예상 시간**: 6-8시간

---

#### T4.3 승리 연출 강화
**현재**: 카메라 줌 + 결과 화면  
**목표**: 극적인 승리 연출

**구현 내용:**
- [ ] 1등 말 승리 포즈 애니메이션
- [ ] 트랙에 결승선 효과
- [ ] 느린 모션 피니시
- [ ] 승리 BGM
- [ ] 관중 환호 사운드
- [ ] 스포트라이트 효과

**예상 난이도**: ⭐⭐⭐  
**예상 시간**: 4-5시간

---

#### T4.4 멀티플레이어 (온라인)
**현재**: 로컬 1인 + AI  
**목표**: 실시간 온라인 대전

**구현 내용:**
- [ ] WebSocket 서버 구축
- [ ] 방 생성/참가 시스템
- [ ] 실시간 동기화
- [ ] 연결 끊김 처리
- [ ] 채팅 기능

**예상 난이도**: ⭐⭐⭐⭐⭐  
**예상 시간**: 15-20시간

---

#### T4.5 통계 및 업적 시스템
**현재**: 없음  
**목표**: 플레이어 동기 부여

**구현 내용:**
- [ ] LocalStorage에 통계 저장
- [ ] 총 게임 수, 승률
- [ ] 가장 많이 이긴 말
- [ ] 업적 시스템:
  - 첫 승리
  - 10연승
  - 다크호스로 대역전
  - 등등
- [ ] 업적 팝업 알림

**예상 난이도**: ⭐⭐⭐  
**예상 시간**: 5-6시간

---

## 구현 순서 권장

### Phase A: 핵심 규칙 완성 (1주일)
1. T1.1 베팅 카드 선택 시스템
2. T1.2 말 배치 페이즈
3. T1.3 Exchange Betting Card
4. T1.4 다중 말 카드

### Phase B: 감각 강화 (1주일)
1. T2.1 사운드 시스템
2. T2.2 시각 효과 (VFX)
3. T3.3 결과 화면 개선

### Phase C: UX 개선 (3-4일)
1. T3.1 카드 정보 팝업
2. T3.2 진행 상황 표시
3. T2.4 게임 시작 설정 화면

### Phase D: 게임성 심화 (1주일)
1. T2.3 AI 전략 개선
2. T3.4 튜토리얼 시스템
3. T4.1 레이싱 카메라 모드

### Phase E: 고급 기능 (2주일+)
1. T4.3 승리 연출 강화
2. T4.5 통계 및 업적 시스템
3. T4.2 게임 리플레이
4. T4.4 멀티플레이어

---

## 예상 총 소요 시간

| 우선순위 | 과제 수 | 예상 시간 |
|----------|---------|-----------|
| Priority 1 (Critical) | 4개 | 14-18시간 |
| Priority 2 (High) | 4개 | 18-23시간 |
| Priority 3 (Medium) | 4개 | 9-13시간 |
| Priority 4 (Low) | 5개 | 34-44시간 |
| **총계** | **17개** | **75-98시간** |

---

## 기술적 고려사항

### 새로 필요한 모듈
- `src/game/AIPlayer.js` - AI 로직 분리
- `src/audio/SoundManager.js` - 사운드 관리
- `src/effects/ParticleSystem.js` - 파티클 효과
- `src/ui/TutorialManager.js` - 튜토리얼
- `src/game/ReplayManager.js` - 리플레이

### 외부 라이브러리 (선택)
- **Howler.js** - 사운드 관리
- **GSAP** - 고급 애니메이션
- **Confetti.js** - 컨페티 효과

### 자산 필요
- 효과음 파일 (8-10개)
- 배경 음악 (1-2곡)
- 파티클 텍스처

---

## 참고 문서

- `docs/GAME_RULES.md` - 공식 게임 규칙
- `docs/QUICK_REFERENCE.md` - 빠른 규칙 참조
- `docs/ARCHITECTURE.md` - 시스템 아키텍처
- `TASK.md` - 리팩토링 히스토리

---

**문서 버전**: 1.0  
**작성일**: 2026-02-05  
**작성자**: AI 분석
